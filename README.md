# CRUD API Project

## Описание

Проект представляет собой CRUD API для управления пользователями, работающий с in-memory базой данных.

## Технологии

- Node.js (v22.x.x)
- TypeScript
- In-memory база данных
- Jest для тестирования
- Cluster API для горизонтального масштабирования

## Установка и настройка

### 1. Клонирование репозитория

Клонируйте репозиторий на ваш локальный компьютер:

```bash
git clone https://github.com/hell-llex/node-crud-api.git
```

### 2. Установка зависимостей

Перейдите в директорию проекта и установите все необходимые зависимости:

```bash
cd node-crud-api
npm install
```

### 3. Настройка окружения

Создайте файл `.env` на основе примера `.env.example` в корне проекта. Пример содержимого файла:

```bash
PORT=4000
```

### 4. Режимы запуска

Проект поддерживает два режима: разработки (development) и продакшн (production), как для одиночного процесса, так и для режима кластера.

**Режим разработки:**

- Одиночный процесс (с горячей перезагрузкой):
  
  ```bash
  npm run start:dev
  ```
  
- Режим кластера (с горячей перезагрузкой):

  ```bash
  npm run start:dev-multi
  ```

**Продакшн режим:**

- Одиночный процесс:

  ```bash
  npm run start:prod
  ```

- Режим кластера:

  ```bash
  npm run start:multi
  ```

> **Примечание:** В продакшн режиме приложение запускается без предварительной сборки проекта, он сразу собирается и запускается.

### 5. Горизонтальное масштабирование (Cluster Mode)

Режим кластера используется для обработки запросов несколькими процессами.

- В режиме разработки кластер запускается с горячей перезагрузкой.
- В продакшн режиме кластер используется для масштабирования и повышения производительности.

В режиме кластера реализована балансировка нагрузки по алгоритму Round-robin. Например, если `PORT=4000`, кластер будет распределять запросы между следующими адресами:

- `localhost:4001`
- `localhost:4002`
- `localhost:4003` и так далее.

### 6. Тестирование

Проект содержит тесты на Jest. Для запуска тестов выполните команду:

```bash
npm test
```

## Тестирование API с помощью Postman

### 1. Импорт коллекции запросов

Для удобного тестирования API импортируйте файл `crud-api-requests.json` в Postman:

1. Откройте Postman.
2. Нажмите **Import** в верхнем левом углу.
3. Выберите **File** и укажите путь к файлу `crud-api-requests.json`.
4. Нажмите **Import**.

Теперь в Postman доступны преднастроенные запросы для тестирования API.

### 2. Примеры запросов

- Получение всех пользователей (GET запрос):

  ```URL: http://localhost:4000/api/users```

- Создание пользователя (POST запрос):

  ```URL: http://localhost:4000/api/users```

  **Body (JSON):**

  ```json
  {
    "username": "John Doe",
    "age": 30,
    "hobbies": ["reading", "gaming"]
  }
  ```

- Обновление пользователя (PUT запрос):

  ```URL: http://localhost:4000/api/users/{userId}```

  **Body (JSON):**

  ```json
  {
    "username": "John Updated",
    "age": 31,
    "hobbies": ["sports"]
  }
  ```

- Удаление пользователя (DELETE запрос):

  ```URL: http://localhost:4000/api/users/{userId}```

